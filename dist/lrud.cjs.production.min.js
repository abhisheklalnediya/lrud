"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,n=require("react"),o=(e=n)&&"object"==typeof e&&"default"in e?e.default:e;function r(){return(r=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e}).apply(this,arguments)}function t(e,n,o){if(n>o)throw new RangeError("`min` should be lower than `max`");return e<n?n:e>o?o:e}function i(e,n,o){return void 0===o&&(o=!1),o?function(e,n){return e-Math.floor(e/n)*n}(n,e):t(n,0,e-1)}function u(e,n){if(!n)return!1;if(n.disabled||n.isExiting||n.trap)return!1;var o=n.children||[];if(0===o.length)return!0;for(var r=!1,t=0;t<o.length;t++)if(u(e,e.nodes[o[t]])){r=!0;break}return!!r}function a(e,n){var o=e[n.parentId],t=o.children.filter((function(n){var o=e[n];return o&&!o.disabled&&!o.isExiting})).indexOf(n.focusId),i=e[o.parentId],u=i.children.filter((function(n){var o=e[n];return o&&!o.disabled&&!o.isExiting}));return r({},i,{_gridColumnIndex:t,_gridRowIndex:u.indexOf(o.focusId)})}function d(e){var n=e.nodes,o=e.callbackName,t=e.arg;[].concat(e.nodeIds).reverse().forEach((function(e){var i=n[e];if(i){var u=i[o];"function"==typeof u&&u(r({},t,{currentNode:i}))}}))}function c(e){var n=e.focusState,o=function(e){var n=e.focusState,o=e.assignFocusTo,r=e.orientation,i=e.preferEnd;return function(e){var n=e.focusState,o=e.propagateFromId,r=e.orientation,i=e.preferEnd,a=n.nodes[o],d=[];return a.trap&&(d=a._focusTrapPreviousHierarchy),[].concat(function e(n){var o=n.focusState,r=n.currentFocusHierarchy,t=void 0===r?[]:r,i=o.nodes[n.nodeId];if(!i)return[];var u=i.parentId;return null===u?t:e({focusState:o,nodeId:u,currentFocusHierarchy:[u].concat(t)})}({focusState:n,nodeId:o}),[o],function e(n){var o=n.focusState,r=n.currentFocusHierarchy,i=void 0===r?[]:r,a=n.orientation,d=n.preferEnd,c=n.preferredChildren,s=o.nodes[n.nodeId];if(!s)return[];var l=s.children.filter((function(e){return u(o,o.nodes[e])})),f=[];if(0===l.length)return i;if("grid"===s.navigationStyle&&(!c||0===c.length)){var v,p,g=t(null!=(v=s.defaultFocusRow)?v:0,0,s.children.length-1),h=s.children[g],w=o.nodes[h];if(!w||0===w.children.length)return[].concat(i,[h]);var y=t(null!=(p=s.defaultFocusColumn)?p:0,0,w.children.length-1),F=w.children[y];return e({focusState:o,nodeId:F,currentFocusHierarchy:[].concat(i,[h,F]),preferredChildren:[]})}var I=l[0],N="number"==typeof s.defaultFocusChild&&Number.isFinite(s.defaultFocusChild);if(!N&&"function"!=typeof s.defaultFocusChild||"grid"===s.navigationStyle){if(c&&c.length){var x=c[0];o.nodes[x]&&(I=x,f=c.slice(1))}if(a&&a===s.orientation){var S=!("grid"===s.navigationStyle)&&d,m=Math.max(0,l.length-1);I=l[S?m:0]}}else{var C=0;I="number"==typeof(C=N?s.defaultFocusChild:s.defaultFocusChild())&&Number.isFinite(C)?l[C=t(C,0,Math.max(0,l.length-1))]:l[0]}return e({focusState:o,nodeId:I,currentFocusHierarchy:[].concat(i,[I]),preferredChildren:f})}({focusState:n,nodeId:o,orientation:r,preferEnd:i,preferredChildren:d}))}("string"==typeof o&&o!==n.focusedNodeId?{focusState:n,propagateFromId:o,orientation:r,preferEnd:i}:{focusState:n,propagateFromId:n.focusedNodeId,orientation:r,preferEnd:i})}({focusState:n,assignFocusTo:e.assignFocusTo,orientation:e.orientation,preferEnd:e.preferEnd}),i=function(e){for(var n=e.focusHierarchy,o=void 0===n?[]:n,r=e.prevFocusHierarchy,t=void 0===r?[]:r,i=Math.max(o.length,t.length),u=NaN,a=0;a<i;a++)if(t[a]!==o[a]){u=a;break}if(Number.isNaN(u))return{blur:[],focus:[],unchanged:t};var d=t.slice(0,u);return{blur:t.slice(u),focus:o.slice(u),unchanged:d}}({focusHierarchy:o,prevFocusHierarchy:n.focusHierarchy}),c=i.blur,s=i.focus,l=i.unchanged;if(!c.length&&!s.length)return n;var f,v=function(e){for(var n=e.focusState,o=e.blurHierarchy,t=e.focusHierarchy,i=e.unchangedHierarchy,u={},d=0;d<i.length;d++){var c=i[d],s=n.nodes[c];if(s){var l=d===i.length-1,f=l&&!t.length;if(s.isFocusedLeaf!==f&&(u[c]=r({},s,{isFocusedLeaf:f})),l&&t.length){var v=s.children.indexOf(t[0]);u[c]=r({},s,u[c],{prevFocusedChildIndex:s.focusedChildIndex,focusedChildIndex:v})}}}for(var p=0;p<o.length;p++){var g=o[p],h=n.nodes[g];if(h&&(u[g]=r({},h,{isFocused:!1,isFocusedLeaf:!1,prevFocusedChildIndex:h.focusedChildIndex,focusedChildIndex:null}),"grid"===h.navigationStyle&&(u[g]._gridColumnIndex=0,u[g]._gridRowIndex=0),h.trap&&!h.forgetTrapFocusHierarchy)){var w=o.slice(p+1);u[g]._focusTrapPreviousHierarchy=w}}for(var y=0;y<t.length;y++){var F=t[y],I=n.nodes[F],N=y===t.length-1;if(u[F]=r({},I,{isFocused:!0,isFocusedLeaf:y===t.length-1}),I.trap&&(u[F]._focusTrapPreviousHierarchy=[]),!N){var x=I.children.indexOf(t[y+1]);u[F].prevFocusedChildIndex=I.focusedChildIndex,u[F].focusedChildIndex=x}if("grid-item"===I.nodeNavigationItem){var S=a(r({},n.nodes,u),u[F]);u[S.focusId]=S}}return u}({focusState:n,blurHierarchy:c,focusHierarchy:s,unchangedHierarchy:l});f=s.length?s[s.length-1]:l[l.length-1];var p={_updatingFocusIsLocked:!1,nodes:r({},n.nodes,v),focusHierarchy:o,focusedNodeId:f,activeNodeId:n.activeNodeId,interactionMode:n.interactionMode,_hasPointerEventsEnabled:n._hasPointerEventsEnabled};return function(e){var n=e.focus,o=e.blur,r=e.focusState,t=o.slice(-1)[0],i=n.slice(-1)[0],u=void 0!==t?r.nodes[t]:void 0,a=void 0!==i?r.nodes[i]:void 0;d({nodeIds:o,nodes:r.nodes,callbackName:"onBlurred",arg:{blurNode:u,focusNode:a}}),d({nodeIds:n,nodes:r.nodes,callbackName:"onFocused",arg:{blurNode:u,focusNode:a}})}({focus:s,blur:c,focusState:p}),p}function s(e){var n=e.focusState,o=e.focusedNode;if("grid-item"===o.nodeNavigationItem){var r=n.nodes[o.parentId];if(!r)return null;var t=n.nodes[r.parentId];return t?{gridNode:t,rowNode:r}:null}if("grid-row"===o.nodeNavigationItem){var i=n.nodes[o.parentId];return i?{gridNode:i,rowNode:o}:null}return null}function l(e,n,o){var r=e[n];"function"==typeof r&&r({isArrow:o.isArrow,key:o.key,node:e,stopPropagation:o.stopPropagation,preventDefault:o.preventDefault,targetNode:o.targetNode})}var f=["defaultFocusChild","disabled","isExiting","defaultFocusColumn","defaultFocusRow","wrapping","trap","forgetTrapFocusHierarchy"],v={ArrowUp:"up",ArrowDown:"down",ArrowLeft:"left",ArrowRight:"right",Enter:"select",Escape:"back"},p=o.createContext(null),g={Context:p,FocusRoot:function(e){var t=e.orientation,a=e.wrapping,d=e.children,g=e.pointerEvents,h=e.throttle,w=void 0===h?0:h,y=n.useRef(null),F=n.useState((function(){var e=function(e){var n=void 0===e?{}:e,o=n.orientation,t=n.wrapping,a=n.pointerEvents,d=void 0!==a&&a,v={focusedNodeId:"root",activeNodeId:null,focusHierarchy:["root"],interactionMode:"lrud",_hasPointerEventsEnabled:d,_updatingFocusIsLocked:!1,nodes:{root:{elRef:{current:null},focusId:"root",isRoot:!0,parentId:null,active:!1,isExiting:!1,isFocused:!0,isFocusedLeaf:!0,trap:!1,disabled:!1,defaultFocusColumn:0,defaultFocusRow:0,orientation:void 0===o?"horizontal":o,wrapping:void 0!==t&&t,navigationStyle:"first-child",nodeNavigationItem:"default",forgetTrapFocusHierarchy:!0,children:[],focusedChildIndex:null,prevFocusedChildIndex:null,_gridColumnIndex:null,_gridRowIndex:null,wrapGridVertical:!1,wrapGridHorizontal:!1,_focusTrapPreviousHierarchy:[]}}},p=[];function g(){for(var e=0;e<p.length;e++)(0,p[e])()}var h=!1,w=!1;function y(){w||(w=!0,requestAnimationFrame((function(){!function(e){if("pointer"!==v.interactionMode){var n=r({},v,{interactionMode:"pointer"});v=n}}(),w=!1})))}function F(){h=!0,window.addEventListener("mousemove",y),window.addEventListener("mousedown",y)}function I(){h=!1,window.removeEventListener("mousemove",y),window.removeEventListener("mousedown",y)}function N(e){!function(e,n){var o=e.getState(),r="up"===n||"down"===n||"right"===n||"left"===n,t="select"===n,i="back"===n,u=!1,a=!1,d=o.focusHierarchy.slice().reverse();if(d.length){var c=function(){u=!0},s=function(){a=!0},f=o.nodes[d[0]];d.forEach((function(e){if(!a){var u=o.nodes[e];u&&(l(u,"onKey",{isArrow:r,key:n,targetNode:f,preventDefault:c,stopPropagation:s}),r&&l(u,"onArrow",{isArrow:r,key:n,targetNode:f,preventDefault:c,stopPropagation:s}),"left"===n&&l(u,"onLeft",{isArrow:r,key:n,targetNode:f,preventDefault:c,stopPropagation:s}),"right"===n&&l(u,"onRight",{isArrow:r,key:n,targetNode:f,preventDefault:c,stopPropagation:s}),"up"===n&&l(u,"onUp",{isArrow:r,key:n,targetNode:f,preventDefault:c,stopPropagation:s}),"down"===n&&l(u,"onDown",{isArrow:r,key:n,targetNode:f,preventDefault:c,stopPropagation:s}),t&&l(u,"onSelected",{isArrow:r,key:n,targetNode:f,stopPropagation:s,preventDefault:function(){}}),i&&l(u,"onBack",{isArrow:r,key:n,targetNode:f,stopPropagation:s,preventDefault:function(){}}))}}))}r&&!u?e.handleArrow(n):t&&!u&&e.handleSelect()}(x,e)}d&&F();var x={subscribe:function(e){p.push(e);var n=!0;return function(){if(n){n=!1;var o=p.indexOf(e);p.splice(o,1)}}},getState:function(){return v},createNodes:function(e,n){var o=function(e){for(var n=e.focusState,o=e.nodeDefinitionHierarchy,t=e.nodeHierarchy,u={},a=null,d=n._updatingFocusIsLocked,c=0;c<o.length;c++){var s=t[c],l=c===o.length-1,f=o[c],v=!n.nodes[f.focusId];if(void 0!==f.onMountAssignFocusTo&&(l?(d=!1,a=f.onMountAssignFocusTo):d=!0),"grid"===f.navigationStyle&&(f.defaultFocusColumn||f.defaultFocusRow))if(l){d=!1;var p=n.nodes[s.focusId];if(p){var g,h,w,y,F=i(p.children.length,null!=(g=f.defaultFocusRow)?g:0,p.wrapGridVertical),I=n.nodes[p.children[F]],N=null!=(h=null==I||null==(w=I.children)?void 0:w.length)?h:0,x=i(N,null!=(y=f.defaultFocusColumn)?y:0,p.wrapGridHorizontal),S=Math.min(x,Math.max(N-1,0)),m=null==I?void 0:I.children[S];m&&(a=m)}}else d=!0;if(v){var C=o[c-1].focusId,b=n.nodes[C]||u[C],E=b.children,H=Array.isArray(E)?E.concat(f.focusId):[f.focusId];u[C]=r({},b,{children:H}),u[f.focusId]=s}}return{nodes:Object.keys(u).length?u:null,assignFocusTo:a,shouldLockFocus:d}}({focusState:v,nodeHierarchy:e,nodeDefinitionHierarchy:n}),t=o.nodes,u=o.assignFocusTo,a=o.shouldLockFocus;if(a&&(v._updatingFocusIsLocked=a),Boolean(t)||!a&&v._updatingFocusIsLocked){var d=r({},v,{nodes:r({},v.nodes,t)});if(a)v=r({},d,{_updatingFocusIsLocked:!0});else{var s=e.map((function(e){return e.focusId})).indexOf(v.focusedNodeId),l=n.findIndex((function(e){return e.onMountAssignFocusTo})),f=d;(s>-1||l>-1)&&(f=c({focusState:d,assignFocusTo:u})),f!==v&&(v=f,g())}}},deleteNode:function(e){var n=function(e){var n,o=e.focusState,t=e.nodeId,i=o.nodes[t];if(!i)return null;if("root"===t)return null;var u=i.parentId;if(!u)return null;var a=o.nodes[u],d=[];a.children.length>1&&(d=a.children.filter((function(e){return e!==t})));var s=r({},o.nodes,((n={})[u]=r({},a,{children:d}),n));delete s[t],function e(n,o){o.forEach((function(o){var r=n[o],t=r?r.children:null;delete n[o],Array.isArray(t)&&e(n,t)}))}(s,i.children);var l=r({},o,{nodes:s});return function(e,n){return-1!==e.indexOf(n)}(o.focusHierarchy,t)&&(l=c({focusState:l,assignFocusTo:u})),l}({focusState:v,nodeId:e});n&&n!==v&&(v=n,g())},setFocus:function(e){var n=v.nodes[e];if(n&&!n.disabled&&!n.isExiting){var o=c({focusState:v,assignFocusTo:e});o!==v&&(v=o,g())}},updateNode:function(e,n){var o=v.nodes[e];if(o&&"root"!==e){var t=void 0!==n.disabled,i=void 0!==n.isExiting;t&&(n.disabled=Boolean(n.disabled)),i&&(n.isExiting=Boolean(n.isExiting));var u=f.some((function(e){return void 0!==n[e]&&o[e]!==n[e]}));if(n&&u){var a,d,s,l,p,h,w,y,F,I=r({},o,{disabled:null!=(a=n.disabled)?a:o.disabled,isExiting:null!=(d=n.isExiting)?d:o.isExiting,defaultFocusColumn:null!=(s=n.defaultFocusColumn)?s:o.defaultFocusColumn,defaultFocusRow:null!=(l=n.defaultFocusRow)?l:o.defaultFocusRow,wrapping:null!=(p=n.wrapping)?p:o.wrapping,trap:null!=(h=n.trap)?h:o.trap,forgetTrapFocusHierarchy:null!=(w=n.forgetTrapFocusHierarchy)?w:o.forgetTrapFocusHierarchy,defaultFocusChild:null!=(y=n.defaultFocusChild)?y:o.defaultFocusChild}),N={};if(i||t){var x={};t&&(x.disabled=n.disabled),i&&(x.isExiting=n.isExiting),N=function e(n,o,t){var i={};return o.forEach((function(o){var u=n[o];if(u){var a=u?u.children:null;if(i[u.focusId]=r({},u,t),Array.isArray(a)){var d=e(n,a,t);i=r({},i,d)}}})),i}(v.nodes,I.children,x)}var S=v.focusHierarchy.find((function(n){return n===e})),m=r({},v,{nodes:r({},v.nodes,N,(F={},F[e]=I,F))});S&&(t||i)&&(m=c({focusState:m,assignFocusTo:I.parentId})),v=m,g()}}},handleArrow:function(e){var n=function(e){var n=e.focusState,o=e.arrow,t="right"===o||"left"===o?"horizontal":"vertical",a="down"===o||"right"===o?"forward":"backward",d=n.nodes[n.focusedNodeId];if(!d)return null;var l,f=function e(n){var o=n.arrow,r=n.focusState,t=n.node,i=n.direction,a=n.orientation;if(t.trap)return null;var d=r.nodes[t.parentId];if(!d)return null;if("grid-item"===t.nodeNavigationItem||"grid-row"===t.nodeNavigationItem){var c=function(e){var n,o,r=e.orientation,t=e.direction,i=s({focusState:e.focusState,focusedNode:e.focusedNode});if(!i)return null;var u=i.gridNode,a=i.rowNode,d="vertical"===r,c="forward"===t,l=null!=(n=u._gridRowIndex)?n:0,f=null!=(o=u._gridColumnIndex)?o:0,v=Math.min(l,u.children.length-1),p=Math.min(f,a.children.length-1);return d&&(u.wrapGridVertical||!(d&&!c&&0===u._gridRowIndex||d&&c&&v===u.children.length-1))||!d&&(u.wrapGridHorizontal||(d||c||0!==u._gridColumnIndex)&&(d||!c||p!==a.children.length-1))?{style:"grid",gridNode:u,rowNode:a}:null}({focusState:r,focusedNode:t,direction:i,orientation:a});if(c)return c;var l=s({focusState:r,focusedNode:t});if(l)return e({arrow:o,focusState:r,node:l.gridNode,direction:i,orientation:a})}var f=function(e,n,o,r){var t=e.nodes[n.parentId];if(!t)return null;if(t.orientation===o){if(t.wrapping)return n;var i=(t.children||[]).filter((function(n){return!!u(e,e.nodes[n])})),a=i.indexOf(n.focusId);return"forward"===r&&a===i.length-1||"backward"===r&&0===a?null:n}return null}(r,t,a,i);return f?{style:"default",targetNode:f}:e({arrow:o,focusState:r,node:d,direction:i,orientation:a})}({arrow:(l={arrow:o,focusState:n,focusedNode:d,direction:a,orientation:t}).arrow,focusState:l.focusState,node:l.focusedNode,direction:l.direction,orientation:l.orientation});return f?"default"===f.style?function(e){var n=e.focusState,o=e.orientation,r=e.targetNode,t=e.direction,u=e.arrow,a=function(e){var n=e.focusState,o=e.targetNode,r=e.direction,t=n.nodes[o.parentId];if(!t)return null;var u="forward"===r?1:-1,a=t.wrapping,d="forward"!==r,c=o.focusId,s=(t.children||[]).filter((function(e){var o=n.nodes[e];return!(!o||o.disabled||o.isExiting||o.trap)})),l=s.indexOf(c),f=s[i(s.length,l+u,a)],v=n.nodes[f];return!v||v.disabled||v.isExiting?null:{newFocusedId:f,preferEnd:d}}({focusState:n,targetNode:r,direction:t});if(!a)return null;var d,s=c({focusState:n,orientation:o,assignFocusTo:a.newFocusedId,preferEnd:a.preferEnd}),l=null;if(r.parentId&&(l=null!=(d=s.nodes[r.parentId])?d:null),s!==n&&l&&"function"==typeof l.onMove){var f=l.focusedChildIndex,v=l.prevFocusedChildIndex,p=null===v?null:l.children[v],g=null===p?null:s.nodes[p];l.onMove({orientation:o,direction:t,arrow:u,node:l,prevChildIndex:v,nextChildIndex:f,prevChildNode:null!=g?g:null,nextChildNode:s.nodes[l.children[f]]})}return s}({arrow:o,focusState:n,targetNode:f.targetNode,direction:a,orientation:t}):"grid"===f.style?function(e){var n,o=e.focusState,t=e.orientation,u=e.gridNode,a=e.direction,d=e.arrow,s=function(e){var n,o,r=e.focusState,t=e.gridNode,u=e.rowNode,a="vertical"===e.orientation,d="forward"===e.direction,c=null!=(n=t._gridRowIndex)?n:0,s=null!=(o=t._gridColumnIndex)?o:0,l=Math.min(c,t.children.length-1),f=Math.min(s,u.children.length-1),v=d?1:-1,p=a?i(t.children.length,l+v,t.wrapGridVertical):l,g=a?s:i(u.children.length,f+v,t.wrapGridHorizontal),h=r.nodes[t.children[p]];if(!h)return null;var w=Math.min(g,h.children.length-1),y=h.children[w];return null===y?null:{targetFocusId:y,currentRowIndex:c,currentColumnIndex:s,newRowIndex:p,newColumnIndex:g}}({focusState:o,orientation:t,direction:a,gridNode:u,rowNode:e.rowNode});if(!s)return null;var l=s.currentRowIndex,f=s.currentColumnIndex,v=s.newRowIndex,p=s.newColumnIndex,g=c({focusState:o,orientation:t,assignFocusTo:s.targetFocusId,preferEnd:!1}),h=g.nodes[u.focusId];return(l!==v||f!==p)&&"function"==typeof u.onGridMove&&u.onGridMove({orientation:t,direction:a,arrow:d,gridNode:u,prevRowIndex:l,nextRowIndex:v,prevColumnIndex:f,nextColumnIndex:p}),r({},g,{nodes:r({},g.nodes,(n={},n[u.focusId]=r({},h,{_gridColumnIndex:p,_gridRowIndex:v}),n))})}({arrow:o,focusState:n,focusedNode:d,gridNode:f.gridNode,rowNode:f.rowNode,direction:a,orientation:t}):null:null}({focusState:v,arrow:e});n&&("lrud"!==n.interactionMode&&(n.interactionMode="lrud"),n!==v&&(v=n,g()))},handleSelect:function(e){var n,o="string"==typeof e?e:v.focusHierarchy[v.focusHierarchy.length-1],t=v.nodes[o];if(o!==v.activeNodeId&&t){var i=r({},t,{active:!0}),u=((n={})[o]=i,n);if(v.activeNodeId){var a=v.nodes[v.activeNodeId];a&&(u[v.activeNodeId]=r({},a,{active:!1}))}var d=r({},v,{activeNodeId:o,nodes:r({},v.nodes,u)});v=d,g()}},configurePointerEvents:function(e){v=r({},v,{_hasPointerEventsEnabled:e}),e&&!h&&F(),e||I()},destroy:function(){I()},processKey:{select:function(){return N("select")},back:function(){return N("back")},down:function(){return N("down")},left:function(){return N("left")},right:function(){return N("right")},up:function(){return N("up")}}};return x}({orientation:t,wrapping:a,pointerEvents:g});return{store:e,focusDefinitionHierarchy:[{elRef:y,focusId:"root"}],focusNodesHierarchy:[e.getState().nodes.root]}}))[0];return n.useEffect((function(){var e,n,o=(e=F.store,n={up:function(){e.processKey.up()},down:function(){e.processKey.down()},left:function(){e.processKey.left()},right:function(){e.processKey.right()},select:function(){e.processKey.select()},back:function(){e.processKey.back()}},{subscribe:function(e){var o=function(e,n,o){var r,t,i,u=null,a=0;o||(o={});var d=function(){a=!1===o.leading?0:Date.now(),u=null,i=e.apply(r,t),u||(r=t=null)};return function(){var c=Date.now();a||!1!==o.leading||(a=c);var s=n-(c-a);return r=this,t=arguments,s<=0||s>n?(u&&(clearTimeout(u),u=null),a=c,i=e.apply(r,t),u||(r=t=null)):u||!1===o.trailing||(u=setTimeout(d,s)),i}}((function(e){var o=n[v[e.key]];"function"==typeof o&&(e.preventDefault(),e.stopPropagation(),o())}),e,{trailing:!1});return window.addEventListener("keydown",o),function(){window.removeEventListener("keydown",o)}}}).subscribe(w);return function(){o()}}),[]),o.createElement(p.Provider,{value:F},d)}};function h(e){var o=n.useRef();return n.useEffect((function(){o.current=e})),o.current}var w=["elementType","focusId","className","children","wrapping","wrapGridHorizontal","wrapGridVertical","orientation","isGrid","isTrap","forgetTrapFocusHierarchy","defaultFocusColumn","defaultFocusRow","disabled","onMountAssignFocusTo","defaultFocusChild","isExiting","propsFromNode","focusedClass","focusedLeafClass","disabledClass","activeClass","onKey","onArrow","onLeft","onRight","onUp","onDown","onSelected","onBack","onMove","onGridMove","onFocused","onBlurred","onClick","onMouseOver"],y=0;function F(e){var n=e.id,o=e.setNode,r=e.currentNode,t=e.focusStore.getState().nodes[n];t&&t!==r&&!t.isExiting&&o(t)}function I(e,t){var i=e.elementType,u=void 0===i?"div":i,a=e.focusId,d=e.className,c=void 0===d?"":d,s=e.children,l=e.wrapping,f=void 0!==l&&l,v=e.wrapGridHorizontal,p=e.wrapGridVertical,I=e.orientation,N=e.isGrid,x=void 0!==N&&N,S=e.isTrap,m=void 0!==S&&S,C=e.forgetTrapFocusHierarchy,b=void 0!==C&&C,E=e.defaultFocusColumn,H=e.defaultFocusRow,R=e.disabled,M=e.onMountAssignFocusTo,k=e.defaultFocusChild,A=e.isExiting,T=void 0!==A&&A,D=e.propsFromNode,L=e.focusedClass,_=void 0===L?"isFocused":L,B=e.focusedLeafClass,P=void 0===B?"isFocusedLeaf":B,G=e.disabledClass,O=void 0===G?"focusDisabled":G,K=e.activeClass,V=void 0===K?"isActive":K,z=e.onKey,U=e.onArrow,j=e.onLeft,q=e.onRight,J=e.onUp,Q=e.onDown,W=e.onSelected,X=e.onBack,Y=e.onMove,Z=e.onGridMove,$=e.onFocused,ee=e.onBlurred,ne=e.onClick,oe=e.onMouseOver,re=function(e,n){if(null==e)return{};var o,r,t={},i=Object.keys(e);for(r=0;r<i.length;r++)n.indexOf(o=i[r])>=0||(t[o]=e[o]);return t}(e,w),te=n.useRef(null),ie=n.useRef({onKey:z,onArrow:U,onLeft:j,onRight:q,onUp:J,onDown:Q,onSelected:W,onBack:X,onMove:Y,onGridMove:Z,onFocused:$,onBlurred:ee,onClick:ne,onMouseOver:oe});n.useEffect((function(){ie.current={onKey:z,onArrow:U,onLeft:j,onRight:q,onUp:J,onDown:Q,onSelected:W,onBack:X,onMove:Y,onGridMove:Z,onFocused:$,onBlurred:ee,onClick:ne,onMouseOver:oe}}),[z,U,j,q,J,Q,W,X,Y,Z,$,ee,ne,oe]),n.useImperativeHandle(t,(function(){return te.current}));var ue=n.useState((function(){if(a&&("string"==typeof a||void 0===a)&&"root"!==a&&a+""!="")return a;var e="node-"+y;return y+=1,e}))[0],ae=n.useRef(ne),de=n.useRef(oe);ae.current=ne,de.current=oe;var ce=!m&&void 0,se=x?"horizontal":void 0,le=n.useContext(g.Context),fe=n.useState((function(){var e="boolean"==typeof p?p:f,n="boolean"==typeof v?v:f;function o(e){return function(){var n;ie.current&&"function"==typeof ie.current[e]&&(n=ie.current)[e].apply(n,arguments)}}var r={elRef:te,focusId:ue,orientation:I||se,wrapping:Boolean(f),trap:Boolean(m),wrapGridHorizontal:n,wrapGridVertical:e,forgetTrapFocusHierarchy:void 0!==b?b:ce,navigationStyle:x?"grid":"first-child",defaultFocusColumn:null!=E?E:0,defaultFocusRow:null!=H?H:0,onKey:o("onKey"),onArrow:o("onArrow"),onLeft:o("onLeft"),onRight:o("onRight"),onUp:o("onUp"),onDown:o("onDown"),onSelected:o("onSelected"),onBack:o("onBack"),onMove:o("onMove"),onGridMove:o("onGridMove"),initiallyDisabled:Boolean(R),onMountAssignFocusTo:M,defaultFocusChild:k,isExiting:T,onFocused:$,onBlurred:ee};if(!le)throw new Error("No FocusProvider.");var t=le.store,i=le.focusDefinitionHierarchy,u=le.focusNodesHierarchy,a=function(e){var n,o,r,t=e.nodeDefinition,i=e.parentNode,u=t.onKey,a=t.onArrow,d=t.onLeft,c=t.onRight,s=t.onUp,l=t.onDown,f=t.onSelected,v=t.onBack,p=t.onFocused,g=t.onBlurred,h=t.defaultFocusColumn,w=t.defaultFocusRow,y=t.isExiting,F=t.onMove,I=t.onGridMove,N="default";"grid"===t.navigationStyle?N="grid-container":i&&"grid"===i.navigationStyle?N="grid-row":i&&"grid-row"===i.nodeNavigationItem&&(N="grid-item");var x=null!=(n=t.navigationStyle)?n:"first-child",S="grid"===x,m=null!=h?h:0,C=null!=w?w:0;return{elRef:t.elRef,focusId:t.focusId,isRoot:!1,parentId:i.focusId,isExiting:void 0!==y&&y,isFocused:!1,isFocusedLeaf:!1,active:!1,trap:Boolean(t.trap),orientation:null!=(o=t.orientation)?o:"horizontal",wrapping:Boolean(t.wrapping),disabled:Boolean(t.initiallyDisabled),navigationStyle:x,nodeNavigationItem:N,defaultFocusChild:t.defaultFocusChild,defaultFocusColumn:m,defaultFocusRow:C,forgetTrapFocusHierarchy:Boolean(null!=(r=t.forgetTrapFocusHierarchy)&&r),children:[],focusedChildIndex:null,prevFocusedChildIndex:null,_gridColumnIndex:S?m:null,_gridRowIndex:S?C:null,wrapGridHorizontal:Boolean(t.wrapGridHorizontal),wrapGridVertical:Boolean(t.wrapGridVertical),_focusTrapPreviousHierarchy:[],onKey:u,onArrow:a,onLeft:d,onRight:c,onUp:s,onDown:l,onSelected:f,onBack:v,onFocused:p,onBlurred:g,onMove:F,onGridMove:I}}({nodeDefinition:r,parentNode:u[u.length-1]});return{nodeDefinition:r,initialNode:a,providerValue:{store:t,focusDefinitionHierarchy:i.concat(r),focusNodesHierarchy:u.concat(a)}}}))[0],ve=le.store,pe=n.useState((function(){return fe.initialNode})),ge=pe[0],he=pe[1],we=n.useMemo((function(){return"function"==typeof D?D(ge):{}}),[ge,D]),ye=n.useRef(ge);ye.current=ge;var Fe=n.useRef(!1),Ie=n.useMemo((function(){return{disabled:Boolean(R),isExiting:Boolean(T),defaultFocusColumn:E,defaultFocusRow:H,wrapping:f,trap:m,forgetTrapFocusHierarchy:b,defaultFocusChild:k}}),[R,T,E,H,f,m,b,k]),Ne=h(Ie);return n.useEffect((function(){if(Fe.current){var e={},n=!1;for(var o in Ie){var r=Ie[o];r!==Ne[o]&&(n=!0,e[o]=r)}n&&ve.updateNode(ue,e)}}),[Ie,Ne]),n.useEffect((function(){ve.createNodes(fe.providerValue.focusNodesHierarchy,fe.providerValue.focusDefinitionHierarchy),Fe.current=!0;var e=ve.subscribe((function(){return F({focusStore:ve,id:ue,setNode:he,currentNode:ye.current})}));return F({focusStore:ve,id:ue,setNode:he,currentNode:ye.current}),function(){Fe.current=!1,ve.deleteNode(ue),e()}}),[]),o.createElement(g.Context.Provider,{value:fe.providerValue},n.createElement(u,r({},re,we,{ref:te,className:c+" "+(ge.isFocused?_:"")+" "+(ge.isFocusedLeaf?P:"")+" "+(ge.disabled?O:"")+" "+(we&&"string"==typeof we.className?we.className:"")+" "+(ge.active?V:""),children:s,onMouseOver:function(e){var n=fe.providerValue.store.getState();ye.current&&0===ye.current.children.length&&!ye.current.disabled&&n._hasPointerEventsEnabled&&"pointer"===n.interactionMode&&Fe.current&&fe.providerValue.store.setFocus(ue),"function"==typeof de.current&&de.current(e)},onClick:function(e){if("function"==typeof ae.current&&ae.current(e),ye.current&&0===ye.current.children.length&&(!ye.current||!ye.current.disabled)){var n=fe.providerValue.store.getState();n._hasPointerEventsEnabled&&Fe.current&&"pointer"===n.interactionMode&&(ye.current&&"function"==typeof ye.current.onSelected&&fe.providerValue.store.processKey.select(),fe.providerValue.store.handleSelect(ue))}}})))}function N(e){var o=n.useContext(g.Context),r=n.useState((function(){if(o){var n=o.store.getState().nodes[e];return null!=n?n:null}return null})),t=r[0],i=r[1],u=n.useRef(t);u.current=t;var a=n.useRef(e);function d(){var e;if(o){var n=null!=(e=o.store.getState().nodes[a.current])?e:null;n!==u.current&&i(n)}}return a.current=e,n.useEffect(d,[e]),n.useEffect((function(){if(o){d();var e=o.store.subscribe(d);return function(){e()}}}),[]),t}function x(){var e=n.useContext(g.Context),o=n.useState((function(){if(e){var n=e.store.getState();return n.focusHierarchy.map((function(e){return n.nodes[e]}))}return[]})),r=o[0],t=o[1],i=n.useRef(r);function u(){if(e){var n,o,r=e.store.getState(),u=e.store.getState().focusHierarchy;void 0===(n=i.current)&&(n=[]),void 0===(o=u)&&(o=[]),(n.length!==o.length||(n[n.length-1]||{}).focusId!==o[o.length-1])&&t(r.focusHierarchy.map((function(e){return r.nodes[e]})))}}return i.current=r,n.useEffect((function(){if(e){u();var n=e.store.subscribe(u);return function(){n()}}}),[]),r}function S(){var e=n.useContext(g.Context);if(!e)throw new Error("No FocusProvider.");return e.store}var m=function(e,n){return e===n};function C(e,o,r){void 0===r&&(r=m);var t=h(e);n.useEffect((function(){"function"==typeof o&&"function"==typeof r&&(r(e,t)||o(e,t))}),[e,t,r,o])}var b=g.FocusRoot;exports.FocusNode=n.forwardRef(I),exports.FocusRoot=b,exports.useActiveNode=function(){var e=n.useContext(g.Context),o=n.useState((function(){if(e){var n=e.store.getState();if(null===n.activeNodeId)return null;var o=n.nodes[n.activeNodeId];return null!=o?o:null}return null})),r=o[0],t=o[1],i=n.useRef(r);function u(){var n;if(e){var o=e.store.getState();if(o.activeNodeId){var r=null!=(n=o.nodes[o.activeNodeId])?n:null;r!==i.current&&t(r)}else t(null)}}return i.current=r,n.useEffect((function(){if(e){u();var n=e.store.subscribe(u);return function(){n()}}}),[]),r},exports.useFocusEvents=function(e,o){void 0===o&&(o={});var r=N(n.useState(e)[0]),t=n.useRef(r);t.current=r;var i=n.useRef(o);i.current=o;var u,a=Boolean(r&&r.isFocused);u=r?r.disabled:null;var d=Boolean(r&&r.active);C(e,(function(e,n){})),C(a,(function(e){t.current&&(e&&"function"==typeof i.current.focus?i.current.focus(t.current):e||"function"!=typeof i.current.blur||i.current.blur(t.current))})),C(u,(function(e,n){void 0!==n&&null!=n&&t.current&&(e&&"function"==typeof i.current.disabled?i.current.disabled(t.current):e||"function"!=typeof i.current.enabled||i.current.enabled(t.current))})),C(d,(function(e){t.current&&(e&&"function"==typeof i.current.active?i.current.active(t.current):e||"function"!=typeof i.current.inactive||i.current.inactive(t.current))}))},exports.useFocusHierarchy=x,exports.useFocusNode=function(e){return n.useEffect((function(){}),[]),N(e)},exports.useFocusNodeById=N,exports.useFocusStoreDangerously=S,exports.useLeafFocusedNode=function(){var e=x(),o=n.useMemo((function(){var n;return null==e||null==(n=e[e.length-1])?void 0:n.focusId}),[e]);return N(null!=o?o:"")},exports.useProcessKey=function(){return S().processKey},exports.useSetFocus=function(){var e=n.useContext(g.Context);if(!e)throw new Error("No FocusProvider.");return e.store.setFocus};
//# sourceMappingURL=lrud.cjs.production.min.js.map
